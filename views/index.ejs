<script>
  var emulator;
	$(document).ready( function(){
		emulator = new JSNES({
			'ui': $("#emulator").JSNESUI({
				"Nintendo": [["Contra", "/roms/Contra.nes"],
										 ["Dr. Mario", "/roms/Dr_Mario.nes"],
										 ["Bubble Bobble", "/roms/Bubble_Bobble.nes"],
										 ["Bubble Bobble 2", "/roms/Bubble_Bobble2.nes"]],
				"Homebrew": [["Concentration Room", "/roms/croom.nes"]]
			})
		});

		// master = new joynes.Master(masterNes);

    //var socket = new WebSocket('ws://' + document.location.hostname + ':8080/');
    var socket = io.connect('http://' + document.location.hostname + ':3333/');
    socket.on("role", function(evt) {
      console.log(evt);
      var message = JSON.parse(evt);
      if (message.initialize) {
        switch (message.initialize) {
          case 'm': joynesClient = new joynes.Master(emulator, socket); break;
          case 's': joynesClient = new joynes.Slave(emulator, socket); break;
		  default: alert("something's wrong");
        }
      }
    });
	});
</script>

<div id='tv'>
	<div id="emulator"></div>
</div>
<div id="brief">
	<div id="logo">JOYNES</div>
	<div id="disclaimer">
		Runs best on <a href="http://chrome.google.com">Google Chrome</a>, works with
		<a href="http://apple.com/safari">Safari</a>.
	</div>
	<br>
	Enjoy multiplayer NES goodness with random strangers from around the world. Select a ROM to be first player. Visit
	<a href="/slave">/slave</a> to be 2nd player.
	<a href="http://nodeknockout.com/teams/copypastel" target="nko" title="Help me win Node.js KO!">
		<img style="width: 123px; height: 63px; margin: 0 auto; display: block;"
				 src="http://nodeknockout.com/images/voteko.png"
				 alt="Help me win Node.js KO!" />
	</a>
</div>
<a href="http://joyent.com">
	<div id='sponsors'></div>
</a>

